# 도커 친화적인 애플리케이션 - 이식성이 높은 애플리케이션 구축

> p.98 - 101



## Q. 이식성이 높은 애플리케이션을 구축하기 위해 어떤 요소가 필요할까?



## 1. 환경 변수를 활용한다.



### 1-1. 실행시 인자를 사용한다.

#### 방법 

* CMD 와 ENTRYPOINT 같은 INSTRUCTION을 사용해서 컨테이너 실행 시 사용할 명령어를 정의 해 두거나, 실행시 인자 형태로 값을 전달 받는 방법이 있다.

#### 장점

* 외부에서 값을 주입받을 수 있다.

#### 단점

* 실행 인자값이 많아지면 애플리케이션에서 인자를 내부 변수로 매핑해주는 처리가 복잡해진다.
* CMD 및 ENTRYPOINT INSTRUCTION 내용을 관리하기가 어려워진다.



### 1-2. 설정 파일을 사용한다.

#### 방법 

* 실행할 애플리케이션에 환경 이름을 부여하고, 이에 따라 설정 파일을 바꿔가며 사용하는 방식

#### 장점

* 특정 애플리케이션은 애플리케이션 리포지토리에 필요한 모든 설정 파일을 갖춰두는 경우가 있다. 해당 경우에는 애플리케이션의 도커 이미지를 각 설정 파일 별로 만들어 두는 방법을 생각할 수 있다.

#### 단점

* 특정 환경에 대한 설정 파일을 도커 이미지에 포함시키면 이식성을 해치게 되므로 도커의 장점을 훼손시킨다.
* 또한 설정과 다른 환경에서 애플리케이션을 실행하려면 컨테이너에 설정 파일을 추가해야 하므로 그때마다 이미지를 새로 빌드해야 한다. 이를 해결하기 위해 호스트에 위치한 환경별 설정 파일을 컨테이너에 마운트해주는 것도 한 가지 방법이지만 호스트에 대한 의존성이 생기므로 관리 운영적인 측면에서 좋지 못한 결과를 낳는다.

### 1-3. 애플리케이션 동작을 환경 변수로 제어

#### 방법 

* 

#### 장점

* 설정 파일 방식의 단점이던 매번 이미지를 다시 빌드하지 않아도 되는 장점을 갖는다.

#### 단점

* 환경 변수는 특성상 키-값의 형태를 가지므로, 계층 구조를 가지기 어렵다는 단점을 존재한다.



### 1-4. 설정 파일에  환경 변수를 포함

#### 방법

* 환경별 설정 파일을 애플리케이션에 포함하는 대신, 설정 파일 템플릿에 환경 변수를 포함하는 것

#### 장점

* 환경 변수의 장점과 설정 파일의 장점을 모두 가질 수 있다.

#### 단점

* 







____________

# 작성일지

20.01.13	최초 작성일

